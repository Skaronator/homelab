apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - base/exitnode.yaml

helmCharts:
  - repo: oci://ghcr.io/fyralabs/chisel-operator
    name: chisel-operator
    version: 0.1.0
    includeCRDs: true
    releaseName: chisel-operator
    valuesFile: values.yaml
    namespace: network

patches:
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: chisel-operator
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/env
        value:
          - name: LOAD_BALANCER_CLASS
            value: chisel
